module.exports = function(app) {
    app.controller('BasicController', ['Messages', 'BasicChat', function(Messages, BasicChat) {

        // Self Object
        var chat = this;
        // Sent Indicator
        chat.status = "";
        // Keep an Array of Messages
        chat.messages = [];
        // Set User Data
        Messages.user({
            name: sillyname()
        });

        // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        // Get Received Messages and Add it to Messages Array.
        // This will automatically update the view.
        // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        var chatmessages = document.querySelector(".chat-messages");
        Messages.receive(function(msg) {
            chat.messages.push(msg);
            setTimeout(function() {
                chatmessages.scrollTop = chatmessages.scrollHeight;
            }, 10);
        });

        // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        // Send Messages
        // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        chat.send = function() {
            Messages.send({
                data: chat.textbox
            });
            chat.status = "sending";
            chat.textbox = "";
            setTimeout(function() {
                chat.status = ""
            }, 1200);
        };

    }]);
}
